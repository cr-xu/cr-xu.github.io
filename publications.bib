# Peer-reviewed publications
@article{xu2023bayesian,
  title = {Bayesian optimization of the beam injection process into a storage ring},
  author = {Xu, Chenran and Boltz, Tobias and Mochihashi, Akira and Santamaria Garcia, Andrea and Schuh, Marcel and M\"uller, Anke-Susanne},
  journal = {Phys. Rev. Accel. Beams},
  volume = {26},
  issue = {3},
  pages = {034601},
  numpages = {11},
  year = {2023},
  month = {Mar},
  publisher = {American Physical Society},
  doi = {10.1103/PhysRevAccelBeams.26.034601},
  url = {https://link.aps.org/doi/10.1103/PhysRevAccelBeams.26.034601},
  abstract = {We have evaluated the data-efficient Bayesian optimization method for the specific task of injection tuning in a circular accelerator. In this paper, we describe the implementation of this method at the Karlsruhe Research Accelerator with up to nine tuning parameters, including the determination of the associated hyperparameters. We show that the Bayesian optimization method outperforms manual tuning and the commonly used Nelder-Mead optimization algorithm in both simulation and experiment. The algorithm was also successfully used to ease the commissioning phase after the installation of new injection magnets and is regularly used during accelerator operations. We demonstrate that the introduction of context variables that include intrabunch scattering effects, such as the Touschek effect, further improves the control and robustness of the injection process.},
}

# Conference proceedings
@inproceedings{xu2023beam,
    author = {Chenran Xu and Erik Bründermann and Anke-Susanne Müller and Andrea Santamaria Garcia and Annika Eichler and Jan Kaiser},
    title = {Beam trajectory control with lattice-agnostic reinforcement learning},
    booktitle = {Proc. IPAC'23},
    pages = {4436-4439},
    paper = {THPL029},
    venue = {Venezia},
    series = {IPAC'23 - 14th International Particle Accelerator Conference},
    number = {14},
    publisher = {JACoW Publishing, Geneva, Switzerland},
    month = {05},
    year = {2023},
    issn = {2673-5490},
    isbn = {978-3-95450-231-8},
    doi = {doi:10.18429/jacow-ipac2023-thpl029},
    url = {https://accelconf.web.cern.ch/ipac2023/papers/thpl029.pdf},
    abstract = {In recent work, it has been shown that reinforcement learning (RL) is capable of outperforming existing methods on accelerator tuning tasks. However, RL algorithms are difficult and time-consuming to train and currently need to be retrained for every single task. This makes fast deployment in operation difficult and hinders collaborative efforts in this research area. At the same time, modern accelerators often reuse certain structures within or across facilities such as transport lines consisting of several magnets, leading to similar tuning tasks. In this contribution, we use different methods, such as domain randomization, to allow an agent trained in simulation to easily be deployed for a group of similar tasks. Preliminary results show that this training method is transferable and allows the RL agent to control the beam trajectory at similar lattice sections of two different real linear accelerators. We expect that future work in this direction will enable faster deployment of learning-based tuning routines, and lead towards the ultimate goal of autonomous operation of accelerator systems and transfer of RL methods to most accelerators.}
}
@inproceedings{xu2023sase,
    author = {Chenran Xu and Erik Bründermann and Anke-Susanne Müller and Andrea Santamaria Garcia},
    title = {{Bayesian Optimization for SASE Tuning at the European XFEL}},
    booktitle = {Proc. IPAC'23},
    pages = {4432-4435},
    paper = {THPL028},
    venue = {Venezia},
    series = {IPAC'23 - 14th International Particle Accelerator Conference},
    number = {14},
    publisher = {JACoW Publishing, Geneva, Switzerland},
    month = {05},
    year = {2023},
    issn = {2673-5490},
    isbn = {978-3-95450-231-8},
    doi = {doi:10.18429/jacow-ipac2023-thpl028},
    url = {https://accelconf.web.cern.ch/ipac2023/papers/thpl028.pdf},
    abstract = {Parameter tuning is a regular task and takes considerable time for daily operations at FEL facilities. In this contribution, we demonstrate SASE pulse energy optimization at the European XFEL with Bayesian optimization (BO) as an alternative approach to the widely used simplex method. Preliminary experimental results show that BO could reach a comparable performance as the simplex method, even with an out-of-the-box implementation. Compared to previous attempts, our version of BO does not require setting hyperparameters via additional measurements, thus effectively reducing the required effort for machine operators to use it during operation. On the other hand, BO has the potential to be further improved by introducing prior physical knowledge about the task and fine-tuning the algorithm to specific tasks. This makes BO a promising candidate for routine tuning tasks at particle accelerators in the future.}
}
@inproceedings{xu2022surrogate,
  author       = {Chenran Xu and Erik Bründermann and Anke-Susanne Müller and Andrea Santamaria Garcia and Jens Schäfer},
  title        = {{Surrogate Modelling of the FLUTE Low-Energy Section}},
  booktitle    = {Proc. IPAC'22},
  pages        = {1182--1185},
  eid          = {TUPOPT070},
  language     = {english},
  keywords     = {simulation, network, gun, electron, controls},
  venue        = {Bangkok, Thailand},
  series       = {International Particle Accelerator Conference},
  number       = {13},
  publisher    = {JACoW Publishing, Geneva, Switzerland},
  month        = {07},
  year         = {2022},
  issn         = {2673-5490},
  isbn         = {978-3-95450-227-1},
  doi          = {10.18429/JACoW-IPAC2022-TUPOPT070},
  url          = {https://jacow.org/ipac2022/papers/tupopt070.pdf},
  abstract     = {{Numerical beam dynamics simulations are essential tools in the study and design of particle accelerators, but they can be prohibitively slow for online prediction during operation or for systematic evaluations of new parameter settings. Machine learning-based surrogate models of the accelerator provide much faster predictions of the beam properties and can serve as a virtual diagnostic or to augment data for reinforcement learning training. In this paper, we present the first results on training a surrogate model for the low-energy section at the Ferninfrarot Linac- und Test-Experiment (FLUTE).}},
}
@inproceedings{xu2022optimization,
  author       = {Chenran Xu and Erik Bründermann and Anke-Susanne Müller and Andrea Santamaria Garcia and Markus Schwarz and Jens Schäfer},
  title        = {{Optimization Studies of Simulated THz Radiation at FLUTE}},
  booktitle    = {Proc. IPAC'22},
  pages        = {2292--2295},
  eid          = {WEPOMS023},
  language     = {english},
  keywords     = {electron, radiation, linac, simulation, synchrotron},
  venue        = {Bangkok, Thailand},
  series       = {International Particle Accelerator Conference},
  number       = {13},
  publisher    = {JACoW Publishing, Geneva, Switzerland},
  month        = {07},
  year         = {2022},
  issn         = {2673-5490},
  isbn         = {978-3-95450-227-1},
  doi          = {10.18429/JACoW-IPAC2022-WEPOMS023},
  url          = {https://jacow.org/ipac2022/papers/wepoms023.pdf},
  abstract     = {{The linac-based test facility FLUTE (Ferninfrarot Linac Und Test Experiment) at KIT will be used to study novel accelerator technology and provide intense THz pulses. In this paper, we present start-to-end simulation studies of FLUTE with different bunch charges. We employ a parallel Bayesian optimization algorithm for different bunch charges of FLUTE to find optimized accelerator settings for the generation of intense THz radiation.}},
}
@inproceedings{nabinger2022transverse,
  author       = {Matthias Nabinger and Anke-Susanne Müller and Michael J. Nasse and Carl Sax and Jens Schäfer and Christina Widmann and Chenran Xu},
  title        = {{Transverse and Longitudinal Modulation of Photoinjection Pulses at FLUTE}},
  booktitle    = {Proc. IPAC'22},
  pages        = {1174--1177},
  eid          = {TUPOPT068},
  language     = {english},
  keywords     = {laser, electron, injection, cathode, controls},
  venue        = {Bangkok, Thailand},
  series       = {International Particle Accelerator Conference},
  number       = {13},
  publisher    = {JACoW Publishing, Geneva, Switzerland},
  month        = {07},
  year         = {2022},
  issn         = {2673-5490},
  isbn         = {978-3-95450-227-1},
  doi          = {10.18429/JACoW-IPAC2022-TUPOPT068},
  url          = {https://jacow.org/ipac2022/papers/tupopt068.pdf},
  abstract     = {{To generate the electrons to be accelerated, a photoinjection laser is used at the linac-based test facility FLUTE (Ferninfrarot Linac- Und Test Experiment) at the Karlsruhe Institute of Technology (KIT). The properties of the laser pulse, such as intensity, laser spot size or temporal profile, are the first parameters to influence the characteristics of the electron bunches. In order to control the initial parameters of the electrons in the most flexible way possible, the laser optics at FLUTE are therefore supplemented by additional setups that allow transverse and longitudinal laser pulse shaping by using so-called Spatial Light Modulators (SLMs). In the future, the control of the SLMs will be integrated into a Machine Learning (ML) supported feedback system for the optimization of the electron bunch properties. In this contribution the first test experiments and results on laser pulse shaping at FLUTE on the way to this project are presented.}},
}
@inproceedings{xu2021machine,
  author       = {Chenran Xu and Erik Bründermann and Annika Eichler and Anke-Susanne Müller and Michael J. Nasse and Andrea Santamaria Garcia and Carl Sax and Christina Widmann},
  title        = {{Machine Learning Based Spatial Light Modulator Control for the Photoinjector Laser at FLUTE}},
  booktitle    = {Proc. IPAC'21},
  pages        = {3332--3335},
  eid          = {WEPAB289},
  language     = {english},
  keywords     = {laser, electron, network, target, experiment},
  venue        = {Campinas, SP, Brazil},
  series       = {International Particle Accelerator Conference},
  number       = {12},
  publisher    = {JACoW Publishing, Geneva, Switzerland},
  month        = {08},
  year         = {2021},
  issn         = {2673-5490},
  isbn         = {978-3-95450-214-1},
  doi          = {10.18429/JACoW-IPAC2021-WEPAB289},
  url          = {https://jacow.org/ipac2021/papers/wepab289.pdf},
  note         = {https://doi.org/10.18429/JACoW-IPAC2021-WEPAB289},
  abstract     = {{FLUTE (Ferninfrarot Linac- und Test-Experiment) at KIT is a compact linac-based test facility for novel accelerator technology and a source of intense THz radiation. FLUTE is designed to provide a wide range of electron bunch charges from the pC- to nC-range, high electric fields up to 1.2 GV/m, and ultra-short THz pulses down to the fs-timescale. The electrons are generated at the RF photoinjector, where the electron gun is driven by a commercial titanium sapphire laser. In this kind of setup the electron beam properties are determined by the photoinjector, but more importantly by the characteristics of the laser pulses. Spatial light modulators can be used to transversely and longitudinally shape the laser pulse, offering a flexible way to shape the laser beam and subsequently the electron beam, influencing the produced THz pulses. However, nonlinear effects inherent to the laser manipulation (transportation, compression, third harmonic generation) can distort the original pulse. In this paper we propose to use machine learning methods to manipulate the laser and electron bunch, aiming to generate tailor-made THz pulses. The method is demonstrated experimentally in a test setup.}},
}
@inproceedings{eichler2021first,
  author       = {Annika Eichler and Erik Bründermann and Florian Burkart and Jan Kaiser and Willi Kuropka and Andrea {Santamaria Garcia} and Oliver Stein and Chenran Xu},
  title        = {{First Steps Toward an Autonomous Accelerator, a Common Project Between DESY and KIT}},
  booktitle    = {Proc. IPAC'21},
  pages        = {2182--2185},
  eid          = {TUPAB298},
  language     = {english},
  keywords     = {electron, laser, controls, operation, simulation},
  venue        = {Campinas, SP, Brazil},
  series       = {International Particle Accelerator Conference},
  number       = {12},
  publisher    = {JACoW Publishing, Geneva, Switzerland},
  month        = {08},
  year         = {2021},
  issn         = {2673-5490},
  isbn         = {978-3-95450-214-1},
  doi          = {10.18429/JACoW-IPAC2021-TUPAB298},
  url          = {https://jacow.org/ipac2021/papers/tupab298.pdf},
  note         = {https://doi.org/10.18429/JACoW-IPAC2021-TUPAB298},
  abstract     = {{Reinforcement Learning algorithms have risen in popularity in recent years in the accelerator physics community, showing potential in beam control and in the optimization and automation of tasks in accelerator operation. The Helmholtz AI project "Machine Learning toward Autonomous Accelerators" is a collaboration between DESY and KIT that works on investigating and developing RL applications for the automatic start-up of electron linear accelerators. The work is carried out in parallel at two similar research accelerators: ARES at DESY and FLUTE at KIT, giving the unique opportunity of transfer learning between facilities. One of the first steps of this project is the establishment of a common interface between the simulations and the machine, in order to test and apply various optimization approaches interchangeably between the two accelerators. In this paper we present the first results on the common interface and its application to beam focusing in ARES, and the idea of laser shaping with spatial light modulators at FLUTE.}},
}

# Preprints
@misc{kaiser2023learning,
      title={Learning to Do or Learning While Doing: Reinforcement Learning and Bayesian Optimisation for Online Continuous Tuning}, 
      author={Jan Kaiser and Chenran Xu and Annika Eichler and Andrea Santamaria Garcia and Oliver Stein and Erik Bründermann and Willi Kuropka and Hannes Dinter and Frank Mayet and Thomas Vinatier and Florian Burkart and Holger Schlarb},
      abstract={Online tuning of real-world plants is a complex optimisation problem that continues to require manual intervention by experienced human operators. Autonomous tuning is a rapidly expanding field of research, where learning-based methods, such as Reinforcement Learning-trained Optimisation (RLO) and Bayesian optimisation (BO), hold great promise for achieving outstanding plant performance and reducing tuning times. Which algorithm to choose in different scenarios, however, remains an open question. Here we present a comparative study using a routine task in a real particle accelerator as an example, showing that RLO generally outperforms BO, but is not always the best choice. Based on the study's results, we provide a clear set of criteria to guide the choice of algorithm for a given tuning task. These can ease the adoption of learning-based autonomous tuning solutions to the operation of complex real-world plants, ultimately improving the availability and pushing the limits of operability of these facilities, thereby enabling scientific and engineering advancements.},
      year={2023},
      eprint={2306.03739},
      archivePrefix={arXiv},
      primaryClass={cs.LG}
}






